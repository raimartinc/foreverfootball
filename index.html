<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Explore football teams—stats, logos, uniforms, and maps!">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://pagead2.googlesyndication.com https://fundingchoicesmessages.google.com https://unpkg.com 'unsafe-inline' 'unsafe-eval'; style-src 'self' https://unpkg.com 'unsafe-inline'; img-src 'self' https://* data:; connect-src 'self' https://*.tile.openstreetmap.org https://googleads.g.doubleclick.net">
    <title>Forever Football</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9925950012374716" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; font-family: Arial; background: #f0f0f0; }
        .container { display: flex; height: 100vh; }
        .ad-left, .ad-right { width: 160px; height: 600px; position: fixed; top: 50%; transform: translateY(-50%); }
        .ad-left { left: 10px; } .ad-right { right: 10px; }
        .main { flex: 1; padding: 20px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { padding: 10px 20px; background: #FF4500; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .tab-btn.active { background: #FFA500; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        #team-select { margin-bottom: 20px; }
        select { padding: 10px; font-size: 16px; margin-right: 10px; }
        #team-details { font-size: 18px; }
    </style>
</head>
<body>
    <div class="ad-left"><ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-9925950012374716" data-ad-slot="1870038338"></ins></div>
    <div class="container">
        <div class="main">
            <h1>Forever Football</h1>
            <div class="tabs">
                <button class="tab-btn active" onclick="showTab('teams')">Teams</button>
                <button class="tab-btn" onclick="showTab('map')">Map</button>
            </div>
            <div id="teams" class="tab-content active">
                <div id="team-select">
                    <select id="country"><option value="">Select Country</option></select>
                    <select id="city"><option value="">Select City</option></select>
                    <select id="team"><option value="">Select Team</option></select>
                </div>
                <div id="team-details"></div>
            </div>
            <div id="map" class="tab-content"></div>
        </div>
    </div>
    <div class="ad-right"><ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-9925950012374716" data-ad-slot="5222722308"></ins></div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="teams.js"></script>
    <script>
        console.log('Main script started');

        function showTab(tabId) {
            console.log('Tab clicked:', tabId);
            const contents = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');
            contents.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`button[onclick="showTab('${tabId}')"]`).classList.add('active');
            if (tabId === 'map') initMap();
        }

        let mapInitialized = false;
        function initMap() {
            console.log('Map init called');
            if (!mapInitialized && typeof L !== 'undefined') {
                const map = L.map('map').setView([20, 0], 2);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '© OpenStreetMap' }).addTo(map);
                if (typeof teams !== 'undefined') {
                    teams.forEach(team => {
                        L.marker([team.lat, team.lon]).addTo(map)
                            .bindPopup(`${team.name} (${team.country})<br>${team.league}<br>${team.stadium}`);
                    });
                }
                mapInitialized = true;
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded');
            try {
                (adsbygoogle = window.adsbygoogle || []).push({});
                (adsbygoogle = window.adsbygoogle || []).push({});

                console.log('Teams check:', typeof teams);
                if (typeof teams === 'undefined') {
                    console.error('teams.js not loaded!');
                    return;
                }

                console.log('Teams count:', teams.length);
                const countrySelect = document.getElementById('country');
                const citySelect = document.getElementById('city');
                const teamSelect = document.getElementById('team');
                const details = document.getElementById('team-details');

                const countries = [...new Set(teams.map(t => t.country))].sort();
                console.log('Countries:', countries);
                countries.forEach(country => {
                    const option = document.createElement('option');
                    option.value = country;
                    option.textContent = country;
                    countrySelect.appendChild(option);
                });

                countrySelect.onchange = function() {
                    console.log('Country changed:', this.value);
                    citySelect.innerHTML = '<option value="">Select City</option>';
                    teamSelect.innerHTML = '<option value="">Select Team</option>';
                    details.innerHTML = '';
                    if (this.value) {
                        const cities = [...new Set(teams.filter(t => t.country === this.value).map(t => t.city))].sort();
                        console.log('Cities:', cities);
                        cities.forEach(city => {
                            const option = document.createElement('option');
                            option.value = city;
                            option.textContent = city;
                            citySelect.appendChild(option);
                        });
                    }
                };

                citySelect.onchange = function() {
                    console.log('City changed:', this.value);
                    teamSelect.innerHTML = '<option value="">Select Team</option>';
                    details.innerHTML = '';
                    if (this.value) {
                        const teamList = teams.filter(t => t.country === countrySelect.value && t.city === this.value).sort((a, b) => a.name.localeCompare(b.name));
                        console.log('Teams:', teamList.map(t => t.name));
                        teamList.forEach(team => {
                            const option = document.createElement('option');
                            option.value = team.name;
                            option.textContent = team.name;
                            teamSelect.appendChild(option);
                        });
                    }
                };

                teamSelect.onchange = function() {
                    console.log('Team changed:', this.value);
                    details.innerHTML = '';
                    if (this.value) {
                        const team = teams.find(t => t.name === this.value);
                        details.innerHTML = `
                            <div><strong>Name:</strong> ${team.name} ${team.active ? '' : '(Defunct)'}</div>
                            <div><strong>Country:</strong> ${team.country}</div>
                            <div><strong>League:</strong> ${team.league}</div>
                            <div><strong>City:</strong> ${team.city}</div>
                            <div><strong>Founded:</strong> ${team.founded}</div>
                            <div><strong>Stadium:</strong> ${team.stadium}</div>
                            <div><strong>Trophies:</strong> ${team.trophies} - ${team.funFact}</div>
                            <img src="${team.logo || 'https://via.placeholder.com/200?text=Logo'}" alt="${team.name} Logo" style="max-width: 200px;">
                            <img src="${team.uniform || 'https://via.placeholder.com/200?text=Uniform'}" alt="${team.name} Uniform" style="max-width: 200px;">
                        `;
                    }
                };
            } catch (e) {
                console.error('Script error:', e);
            }
        });
    </script>
</body>
</html>